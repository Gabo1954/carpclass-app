"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3485],{3485:(U,d,s)=>{s.r(d),s.d(d,{LoginPageModule:()=>F});var f=s(177),c=s(4341),i=s(4742),g=s(8465),p=s(467),e=s(4438),v=s(3656),m=s(671);const C=()=>["/reset-password"],L=[{path:"",component:(()=>{var n;class l{constructor(o,t,r,a){this.toastController=o,this.router=t,this.navCtrl=r,this.authService=a,this.login={Usuario:"",Contrasena:""},this.faltante=""}goBack(){this.navCtrl.back()}ngOnInit(){}validateModel(o){for(var[t,r]of Object.entries(o))if(""==r)return this.faltante=t,!1;return!0}validarUsuario(o){return!!(o.length>=3&&(o.includes("@duocuc.cl")||o.includes("@profesor.duoc.cl")))}validarContra(o){return o.length>=8&&o.length<=15}ingresar(){console.log("Datos de inicio de sesi\xf3n:",this.login),this.validateModel(this.login)?this.validarUsuario(this.login.Usuario)?this.validarContra(this.login.Contrasena)?this.authService.login(this.login.Usuario,this.login.Contrasena).subscribe(o=>{var t,r;console.log("Respuesta completa de la API:",o);const a=(null==o||null===(t=o.role)||void 0===t?void 0:t.trim().toLowerCase())||(null==o||null===(r=o.rol)||void 0===r?void 0:r.trim().toLowerCase())||"no especificado";if("no especificado"===a)return void this.presentToast("Error: El rol no fue especificado en la respuesta.");this.authService.storeToken(o.token,a),this.presentToast("\xa1Bienvenido "+this.login.Usuario+"!");let h={state:{user:this.login.Usuario}};"docente"===a?this.router.navigate(["home"],h):"alumno"===a?this.router.navigate(["alumno"],h):this.presentToast(`Rol no reconocido o no especificado: ${a}`)},o=>{console.error("Error al iniciar sesi\xf3n:",o),this.presentToast(401===o.status?"Credenciales inv\xe1lidas. Intenta de nuevo.":"Error al iniciar sesi\xf3n. Por favor, verifica tus credenciales.")}):(this.presentToast("La contrase\xf1a debe tener un m\xednimo de 8 caracteres y un m\xe1ximo de 15."),this.login.Contrasena=""):(this.presentToast("El usuario debe tener al menos 3 caracteres y debe incluir '@duocuc.cl' o '@profesor.duoc.cl'."),this.login.Usuario=""):this.presentToast("Falta rellenar el campo: "+this.faltante)}presentToast(o,t){var r=this;return(0,p.A)(function*(){(yield r.toastController.create({message:o,duration:t||2e3})).present()})()}}return(n=l).\u0275fac=function(o){return new(o||n)(e.rXU(i.K_),e.rXU(g.Ix),e.rXU(v.q9),e.rXU(m.u))},n.\u0275cmp=e.VBU({type:n,selectors:[["app-login"]],decls:25,vars:4,consts:[[1,"ion-padding"],[1,"ion-text-center"],["position","floating"],["type","text","placeholder","Ingrese su usuario",3,"ngModelChange","ngModel"],["type","password","placeholder","Ingrese su contrase\xf1a",3,"ngModelChange","ngModel"],["expand","full",1,"ion-margin-top",3,"click"],[3,"routerLink"]],template:function(o,t){1&o&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Login"),e.k0s()()(),e.j41(4,"ion-content",0)(5,"ion-card")(6,"ion-card-header")(7,"ion-card-title",1)(8,"h2"),e.EFF(9,"Inicio de sesi\xf3n"),e.k0s()()(),e.j41(10,"ion-card-content")(11,"ion-item")(12,"ion-label",2),e.EFF(13,"Usuario"),e.k0s(),e.j41(14,"ion-input",3),e.mxI("ngModelChange",function(a){return e.DH7(t.login.Usuario,a)||(t.login.Usuario=a),a}),e.k0s()(),e.j41(15,"ion-item")(16,"ion-label",2),e.EFF(17,"Contrase\xf1a"),e.k0s(),e.j41(18,"ion-input",4),e.mxI("ngModelChange",function(a){return e.DH7(t.login.Contrasena,a)||(t.login.Contrasena=a),a}),e.k0s()(),e.j41(19,"ion-button",5),e.bIt("click",function(){return t.ingresar()}),e.EFF(20,"Ingresar"),e.k0s(),e.j41(21,"ion-row")(22,"ion-col",1)(23,"a",6),e.EFF(24,"\xbfOlvid\xf3 la contrase\xf1a?"),e.k0s()()()()()()),2&o&&(e.R7$(14),e.R50("ngModel",t.login.Usuario),e.R7$(4),e.R50("ngModel",t.login.Contrasena),e.R7$(5),e.Y8G("routerLink",e.lJ4(3,C)))},dependencies:[c.BC,c.vS,i.Jm,i.b_,i.I9,i.ME,i.tN,i.hU,i.W9,i.eU,i.$w,i.uz,i.he,i.ln,i.BC,i.ai,i.Gw,i.oY,g.Wk]}),l})()}];let M=(()=>{var n;class l{}return(n=l).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[g.iI.forChild(L),g.iI]}),l})(),F=(()=>{var n;class l{}return(n=l).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.$C({type:n}),n.\u0275inj=e.G2t({imports:[f.MD,c.YN,i.bv,M,g.iI]}),l})()}}]);